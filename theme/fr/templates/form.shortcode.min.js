/**
 * Shortcode form
 * Permet l'intégration d'un formulaire kiubi dismoi?
 * 
 * attributs du shortcode
 *  - key Clé unique du formulaire
 * 
 * exemple
 *	 [form key='x-xxxxxxxxxxxxxxx']
 */
(function(a){a.shortcode||a.error("Le plugin shortcode.js est requis");(kiubi&&kiubi.forms)||a.error("Le client API kiubi est requis");a.shortcode.register("form",function(b){if(!b.key){return false}var c=a("<form>");kiubi.forms.get(b.key).done(function(e,d){var f=a("<div>").appendTo(c);createForm(d.fields,f);a("<input>",{type:"submit"}).appendTo(c);c.submit(function(h){h.preventDefault();var g=a(this);var i=kiubi.forms.submit(b.key,g);i.done(function(k,j){g.replaceWith(j.message)});i.fail(function(l,j,k){a("input, textarea, select",g).removeClass("erreur");a("div.erreurs",g).remove();if(k&&k.new_captcha){a("[name=captcha]",g).val("");a("label[for=captcha]",g).html(k.new_captcha+"&nbsp;*")}var m=a("<div>",{"class":"erreurs"});m.insertBefore(f);m.append(j.message);a.each(j.fields,function(){a('[name="'+this.field+'"]',g).addClass("erreur");m.append("<br>"+this.message)})});return false})});return c})})(window.jQuery);